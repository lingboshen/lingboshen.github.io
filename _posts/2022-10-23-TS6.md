---
layout: post
title: Time Series 6&mdash;Multivarite Model
date: 2022-10-23 11:12:00-0400
description: 
tags: note time-series econometics
categories: 
---

 
# Vector Autoregression Model
Consider the first order VAR model (**Structural equation**):

$$\begin{eqnarray*}
  y_t & = & b_{10} - b_{12} z_t + \gamma_{11} y_{t - 1} + \gamma_{12} z_{t -
  1} + \varepsilon_{yt}\\
  z_t & = & b_{20} - b_{21} y_t + \gamma_{21} y_{t - 1} + \gamma_{22} z_{t -
  1} + \varepsilon_{zt}\\
\end{eqnarray*}$$

assume
- $$\{y_t \}$$ and $$\{z_t \}$$ are stationary
- $$\varepsilon_{yt} \sim W.N (0, \sigma_y^2)$$
- $$\varepsilon_{zt} \sim W.N (0, \sigma_z^2)$$
- $$\varepsilon_{yt}, \varepsilon_{zt}$$  are uncorrelated




$$\begin{eqnarray*}
  y_t + b_{12} z_t & = & b_{10} + \gamma_{11} y_{t - 1} + \gamma_{12} z_{t -
  1} + \varepsilon_{yt}\\
  b_{21} y_t + z_t & = & b_{20} + \gamma_{21} y_{t - 1} + \gamma_{22} z_{t -
  1} + \varepsilon_{zt}\\
  \left(\begin{array}{cc}
    1 & b_{12}\\
    b_{21} & 1
  \end{array}\right) \left(\begin{array}{c}
    y_t\\
    z_t
  \end{array}\right) & = & \left(\begin{array}{c}
    b_{10}\\
    b_{20}
  \end{array}\right) + \left(\begin{array}{cc}
    \gamma_{11} & \gamma_{12}\\
    \gamma_{21} & \gamma_{22}
  \end{array}\right) \left(\begin{array}{c}
    y_{t - 1}\\
    z_{t - 1}
  \end{array}\right) + \left(\begin{array}{c}
    \varepsilon_{yt}\\
    \varepsilon_{zt}
  \end{array}\right)\\
  Bx_t & = & \Gamma_0 + \Gamma_1 x_{t - 1} + \varepsilon_t \\
  x_t & = & B^{- 1} \Gamma_0 + B^{- 1} \Gamma_1 x_{t - 1} + B^{- 1}
  \varepsilon_t\\
  & = & A_0 + A_1 x_{t - 1} + e_t\\
  A_0 & = & B^{- 1} \Gamma_0=\left(\begin{array}{cc}
    1 & b_{12}\\
    b_{21} & 1
  \end{array}\right)^{-1}\left(\begin{array}{c}
    b_{10}\\
    b_{20}
  \end{array}\right)\\
  A_1 & = & B^{- 1} \Gamma_1=\left(\begin{array}{cc}
    1 & b_{12}\\
    b_{21} & 1
  \end{array}\right)^{-1}\left(\begin{array}{cc}
    \gamma_{11} & \gamma_{12}\\
    \gamma_{21} & \gamma_{22}
  \end{array}\right)\\
  e_t & = & B^{- 1} \varepsilon_t=\left(\begin{array}{cc}
    1 & b_{12}\\
    b_{21} & 1
  \end{array}\right)^{-1}\left(\begin{array}{c}
    \varepsilon_{yt}\\
    \varepsilon_{zt}
  \end{array}\right)
\end{eqnarray*}$$



Rewrite the vector form $$x_t = A_0 + A_1 x_{t - 1} + e_t$$

$$\begin{eqnarray*}
  y_t & = & a_{10} + a_{11} y_{t - 1} + a_{12} z_{t - 1} + e_{1 t}\\
  z_t & = & a_{20} + a_{21} y_{t - 1} + a_{22} z_{t - 1} + e_{2 t}
\end{eqnarray*}$$



We know that

$$\begin{eqnarray*}
  e_t & = & B^{- 1} \varepsilon_t\\
  & = & \frac{1}{1 - b_{12} b_{21}} 
  \left(\begin{array}{cc}
    1 & - b_{12}\\
    - b_{21} & 1
  \end{array}\right) 
\left(\begin{array}{c}
    \varepsilon_{yt}\\
    \varepsilon_{zt}
  \end{array}\right)\\
  & = & \frac{1}{1 - b_{12} b_{21}} 
  \left(\begin{array}{c}
    \varepsilon_{yt} - b_{12} \varepsilon_{zt}\\
    \varepsilon_{zt} - b_{21} \varepsilon_{yt}
  \end{array}\right)
\end{eqnarray*}$$



So

$$\begin{eqnarray*}
  e_{1 t} & = & \frac{\varepsilon_{yt} - b_{12} \varepsilon_{zt}}{1 - b_{12} b_{21}}\\
  e_{2 t} & = & \frac{\varepsilon_{zt} - b_{21} \varepsilon_{yt}}{1 - b_{12} b_{21}}
\end{eqnarray*}$$



To derive the properties of $$e_t$$

$$\begin{eqnarray*}
  E (e_{1 t}) & = & E \left( \frac{\varepsilon_{yt} - b_{12}
  \varepsilon_{zt}}{1 - b_{12} b_{21}} \right) = 0\\
  E (e_{1 t}^2) & = & E \left[ \left( \frac{\varepsilon_{yt} - b_{12}
  \varepsilon_{zt}}{1 - b_{12} b_{21}} \right)^2 \right]\\
  & = & \frac{\sigma^2_{yt} + b^2_{12} \sigma^2_{zt}}{\left( 1
  - b_{12} b_{21} \right)^2}\\
  E \left( e_{1 t} e_{1 t - i} \right) & = & E \left[ \frac{\left(
  \varepsilon_{yt} - b_{12} \varepsilon_{zt} \right) \left(
  \varepsilon_{yt - i} - b_{12} \varepsilon_{zt - i}
  \right)}{\left. ( 1 - b_{12} b_{21} \right)^2} \right] = 0\\
  E \left( e_{1 t} e_{2 t} \right) & = & E \left[ \frac{\left(
  \varepsilon_{yt} - b_{12} \varepsilon_{zt} \right) \left(
  \varepsilon_{zt} - b_{21} \varepsilon_{yt} \right)}{\left. ( 1
  - b_{12} b_{21} \right)^2} \right]\\
  & = & \frac{- \left( b_{21} \sigma^2_{yt} + b_{12}
  \sigma^2_{zt} \right)}{\left. ( 1 - b_{12} b_{21} \right)^2}
\end{eqnarray*}$$

## Identification
Compare the number of parameters in the structural VAR with the number of parameters from the standard form VAR model. 

$$ 
\begin{array}{llll}
\hline
Form&Estimate&Calculation&N\\\hline
Reduced form&$$a_{10}$$, $$a_{20}$$, $$a_{11}$$, $$a_{12}$$, $$a_{21}$$, $$a_{22}$$&$$var(e_{1t})$$, $$var(e_{2t})$$, $$cov(e_{1t}, e_{2t})$$&9\\
Structural form&$$b_{10}$$, $$b_{20}$$, $$\gamma_{11}$$, $$\gamma_{12}$$, $$\gamma_{21}$$, $$\gamma_{22}$$, $$b_{12}$$, $$b_{21}$$&$$\sigma_y$$, $$\sigma_z$$&10\\
\hline
\end{array}
$$


The primitive system contains 10 parameters, whereas the VAR estimation yields only nine parameters. Unless restrict one of the parameters, it is not possible to identify the primitive system. If exactly one parameter of the primitive system is restricted, the system is exactly identified, and if more than one parameter is restricted, the system is over-identified. 


# VAR

$$\begin{eqnarray*}
Y_t&=&A Y_{t-1}+\epsilon_t= A^2 Y_{t-2} + A \epsilon_{t-1} + \epsilon_t = A^m Y_{t-m}+A^{m-1} \epsilon_{t-m+1}+..+\epsilon_t
\end{eqnarray*}$$

This explodes if $$A^m$$ explodes if $$m \rightarrow \infty$$, this does not explode if it converges to 0. Thus if all eigenvalues of A are smaller than 1 in absolute value.

# Vector Auto Regression: VAR
Definition VAR: for k-variate time series:

$$\begin{eqnarray*}
Y_t&=&c+ \Gamma_1 Y_{t-1} + ... + \Gamma_p Y_{t-p} + \epsilon_t
\\
Y_t: \text{K-dim} \hspace{10mm} c: \text{K-dim} \hspace{10mm} \Gamma_1: \text{K x H -dim} \hspace{10mm} \epsilon_t: \text{K-dim}
\end{eqnarray*}$$

Probalistic analysis VAR(1) identical to AR(1)
Model:

$$\begin{eqnarray*}
Y_t&=&A Y_{t-1}+\epsilon_t \text{, } \hspace{10mm} \epsilon_t  \text{ iid}
\end{eqnarray*}$$


Stationary solution: write as VMA($$\infty$$):

$$\begin{eqnarray*}
Y_t &=& A^m Y_{t-m}+ \sum_{j=0}^{m-1} A^{j} \epsilon_{t-j} \overset{m \to \infty}{\to} \sum_{j=0}^{\infty} A^{j} \epsilon_{t-j} 
\end{eqnarray*}$$
*if all absolute eigenvalues of A $$<$$ 1*


Expectation: 

$$\begin{eqnarray*}
E(Y_t) &=& E(\sum_{j=0}^{\infty} A^{j} \epsilon_{t-j}) = 0 \text{ if } E(\epsilon_t)=0
\end{eqnarray*}$$

Variance:

$$\begin{eqnarray*}
Var(Y_t)&=&Var(\sum_{j=0}^{\infty} A^{j} \epsilon_{t-j})=\sum_{j=0}^{\infty} Var(A^{j} \\
\epsilon_{t-j})&=&\sum_{j=0}^{\infty} A^{j} Var(\epsilon_{t-j}) (A^{j})^T 
\end{eqnarray*}$$

Alternative:

$$\begin{eqnarray*}
Var(Y_t)&=& Var(A Y_{t-1} + \epsilon_t) = Var(A Y_{t-1}) + Var(\epsilon_t) = A Var(Y_{t-1}) A^T + Var(\epsilon_t) = A Var(Y_t) A^T + Var(\epsilon_t).
\end{eqnarray*}$$

Last equality due to stationarity. \\
Slides of Sender, VAR(1):

$$\begin{eqnarray*}
Var(Y_{t+k})&=&\sum_{i=1}^{k} \theta(i)\cdot\Psi\cdot\theta^T(i) \\
\end{eqnarray*}$$

$$\Psi=E(\epsilon_t\cdot\epsilon_t^T)$$
$$\theta(k)=(I+\phi_1+\phi_1^2+\dots+\phi_1^{k-1})$$



# Impulse response functions
For instance: What is the effect on the, say, third component of $$Y_t$$ if $$\epsilon_{t-7}$$ has a unit shock in its second component $$\rightarrow$$ look at $$(A^7)_{3,2}$$.
A not known, but has to be estimated so use Confidence Intervals. To calculate these, use the delta-method.