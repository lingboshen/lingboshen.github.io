<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>        
    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Lingbo  Shen | Rmarkdown Github test</title>
    <meta name="author" content="Lingbo  Shen" />
    <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />

    <meta name="google-site-verification" content="45VVBTzbWI9CPrT2UtIdTtL6imAnvMgtV1VttR2zNGI" />
    
    <!-- Bootstrap & MDB -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

    <!-- Styles -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://lingboshen.github.io/blog/2023/github-rmarkdown-test/">

    <!-- Dark Mode -->
    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
  </head>

  <!-- Body -->
  <body class="fixed-top-nav">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://lingboshen.github.io/"><span class="font-weight-bold">Lingbo</span>   Shen</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">Home</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/cv/">CV</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">Research</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/teaching/">Teaching</a>
              </li>
<!-- Chinese -->
              <li class="nav-item ">
                <a class="nav-link" href="/chinese/">Chinese/中文</a>
              </li>

              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">Blog</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Rmarkdown Github test</h1>
    <p class="post-meta">November 22, 2023• Lingbo Shen</p>
    <p class="post-tags">
      <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>
        ·  
        <a href="/blog/category/code">
          <i class="fas fa-tag fa-sm"></i> code</a>  
          <a href="/blog/category/ggplot">
          <i class="fas fa-tag fa-sm"></i> ggplot</a>  
          <a href="/blog/category/visualization">
          <i class="fas fa-tag fa-sm"></i> visualization</a>  
          <a href="/blog/category/tutorial">
          <i class="fas fa-tag fa-sm"></i> tutorial</a>  
          

    </p>
  </header>

  <article class="post-content">
    <h2 id="introduction">Introduction</h2>

<p>3C data measuring the interaction frequency between two genomic
coordinates can be represented graphically in different ways. Often,
simple barplots are used and comics are drawn to indicate the genomic
position of anchors and restriction fragments of interest. However, this
can be tedious and errorprone. 3C data can also be represented as arcs
spanning from the anchor (aka viewpoint) to the regions of interest (aka
restriction fragments) rendering a precise illustration of the genomic
context. In these plots, the interaction frequency correlates with the
hight of the arc. A published example of such a plot can be found
<a href="https://www.ncbi.nlm.nih.gov/pubmed/26308897" target="_blank" rel="noopener noreferrer">here</a>. To my knowledge,
there is no R package that conveniently generates this kind of plot.
Below is my ggplot solution to generate ‘3C arc plots’. Feel free to
email me with any questions, improvements or comments.</p>

<h3 id="load-packages-and-set-ggplot-themes">Load packages and set ggplot themes</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load required packages</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="c1"># these are general theme settings I commonly use for publication-grade plots</span><span class="w">
</span><span class="n">theme_linedraw_noframe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">theme_linedraw</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">axis.line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(),</span><span class="w">
        </span><span class="n">legend.justification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="c1"># move the legend into the plot</span><span class="w">
</span></code></pre></div></div>

<h3 id="load-data">Load data</h3>

<p>The dummy datasets is an example of an 3C experiment you would do in the
lab: From one specific anchor, the interaction frequencies to 4
different fragments of interest are tested in two different conditions
(control and knock-down). For each condition we have 3 replicates. If
you would like to follow along, download the dummy data
<a href="https://jchellmuth.github.io/downloads/2020-01-03-3C-dummy-data.txt" target="_blank" rel="noopener noreferrer">here</a>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># read 3C data</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_tsv</span><span class="p">(</span><span class="s2">"2020-01-03-3C-dummy-data.txt"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="reformat-data">Reformat data</h3>

<p>The following steps first convert the data to long format (generally
required for plotting with ggplot) using dplyr’s <code class="language-plaintext highlighter-rouge">gather</code>. We then
generate the midpoint between anchor and fragment of interest - this is
essentially the coordinate where the interaction frequency data will be
plotted. We then summarize the data from all three replicates in each
group for each assay (i.e. anchor - fragment pair) using dplyr’s
<code class="language-plaintext highlighter-rouge">group_by</code> and <code class="language-plaintext highlighter-rouge">summarize</code>. To plot a nice arc from anchor, over
midpoint to fragment of interest coordinates, we need to ‘add back’ the
anchor and fragment rows to the long format (this is done by another
<code class="language-plaintext highlighter-rouge">gather</code> command) and set the interaction frequency at these points to 0
(once you look at the final plot, this will make sense). Because
ggplot’s <code class="language-plaintext highlighter-rouge">geom_line</code> needs groups to know which points should be
connected, a new column combining condition and assay.name is generated.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gather to convert from wide to long format</span><span class="w">
</span><span class="n">dfg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="o">-</span><span class="n">assay.name</span><span class="p">,</span><span class="o">-</span><span class="n">anchor.coord</span><span class="p">,</span><span class="o">-</span><span class="n">fragment.coord</span><span class="p">,</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"frequency"</span><span class="p">)</span><span class="w">
</span><span class="c1"># extract condition from sample name</span><span class="w">
</span><span class="n">dfg</span><span class="o">$</span><span class="n">condition</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"\\..*"</span><span class="p">,</span><span class="s2">""</span><span class="p">,</span><span class="n">dfg</span><span class="o">$</span><span class="n">sample</span><span class="p">)</span><span class="w">
</span><span class="c1"># calculate midpoint between each anchor and bait coordinate (the interaction frequency is going to be plotted over this coordinate)</span><span class="w">
</span><span class="n">dfg</span><span class="o">$</span><span class="n">mid.coord</span><span class="o">=</span><span class="p">(</span><span class="n">dfg</span><span class="o">$</span><span class="n">fragment.coord</span><span class="o">+</span><span class="n">dfg</span><span class="o">$</span><span class="n">anchor.coord</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="w">
</span><span class="c1"># summarize data</span><span class="w">
</span><span class="n">dfs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dfg</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span><span class="n">anchor.coord</span><span class="p">,</span><span class="n">fragment.coord</span><span class="p">,</span><span class="n">mid.coord</span><span class="p">,</span><span class="n">assay.name</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">mean.frequency</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">frequency</span><span class="p">),</span><span class="n">sd.frequency</span><span class="o">=</span><span class="n">sd</span><span class="p">(</span><span class="n">frequency</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `summarise()` has grouped output by 'condition', 'anchor.coord',
## 'fragment.coord', 'mid.coord'. You can override using the `.groups` argument.
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 'add back' anchor and fragment rows using gather and rename key / points</span><span class="w">
</span><span class="n">dfsg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dfs</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="o">-</span><span class="n">condition</span><span class="p">,</span><span class="o">-</span><span class="n">mean.frequency</span><span class="p">,</span><span class="o">-</span><span class="n">sd.frequency</span><span class="p">,</span><span class="o">-</span><span class="n">assay.name</span><span class="p">,</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">point</span><span class="p">,</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coord</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">gsub</span><span class="p">(</span><span class="s2">".coord"</span><span class="p">,</span><span class="s2">""</span><span class="p">,</span><span class="n">point</span><span class="p">))</span><span class="w">
</span><span class="c1"># set anchor and probe frequency to 0:</span><span class="w">
</span><span class="n">dfsg</span><span class="o">$</span><span class="n">mean.frequency</span><span class="p">[</span><span class="n">dfsg</span><span class="o">$</span><span class="n">point</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"anchor"</span><span class="p">,</span><span class="s2">"fragment"</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="c1"># add group column (for ggplot's geom_line)</span><span class="w">
</span><span class="n">dfsg</span><span class="o">$</span><span class="n">group</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">dfsg</span><span class="o">$</span><span class="n">condition</span><span class="p">,</span><span class="n">dfsg</span><span class="o">$</span><span class="n">assay.name</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 id="plots">Plots</h2>

<h3 id="3c-arc-plot">3C arc plot</h3>

<p>The basic principle here is to use ggplots <code class="language-plaintext highlighter-rouge">stat_smooth</code> to plot a
second degree polynomial regression line from the anchor over the
midpoint to the fragment of interest genomic coordinates. Note that the
interaction frequency at the anchor and the fragment are set to 0. The
actual interaction frequency data is plotted to the midpoint.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">dfsg</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">mean.frequency</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s2">"smooth"</span><span class="p">,</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">,</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w">
            </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="n">lineend</span><span class="o">=</span><span class="s2">"round"</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.8</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"firebrick"</span><span class="p">,</span><span class="s2">"grey40"</span><span class="p">))</span><span class="o">+</span><span class="w"> </span><span class="c1"># pick colors manually</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">"Relative interaction\nfrequency"</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">"genomic coordinate"</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="c1"># rename axis labels</span><span class="w">
  </span><span class="n">theme_linedraw_noframe</span><span class="w"> </span><span class="c1"># these are the theme settings defined above</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/img/2020-01-03-3C-arc-plot-1.png" alt=""></p>

<h3 id="3c-arc-plot-with-errorbars">3C arc plot with errorbars</h3>

<p>If you like, you could add errorbars to this plot - depending on how
many fragments you are looking at, this could get messy though.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p</span><span class="o">+</span><span class="n">geom_errorbar</span><span class="p">(</span><span class="n">dfsg</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">point</span><span class="o">==</span><span class="s2">"mid"</span><span class="p">),</span><span class="n">inherit.aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span><span class="w">
                </span><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span><span class="n">ymin</span><span class="o">=</span><span class="n">mean.frequency</span><span class="o">-</span><span class="n">sd.frequency</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="n">mean.frequency</span><span class="o">+</span><span class="n">sd.frequency</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">condition</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/img/2020-01-03-3C-arc-plot-w-errorbar-1.png" alt=""></p>

<h3 id="3c-barplot-with-arcs">3C barplot with arcs</h3>

<p>Of course, 3C data can be represented as simple barplots. Here is a
barplot where the 3C arcs are added in. Arcs are only represented for
the most important condition. This could be useful, for example, when
you have multiple conditions that would overcrowd the 3C arc plot above.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">dfsg</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">condition</span><span class="o">==</span><span class="s2">"control"</span><span class="p">),</span><span class="n">mapping</span><span class="o">=</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">mean.frequency</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span><span class="w">
            </span><span class="n">stat</span><span class="o">=</span><span class="s2">"smooth"</span><span class="p">,</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">,</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w">
            </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="n">lineend</span><span class="o">=</span><span class="s2">"round"</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.8</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span><span class="w">
           </span><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fragment.coord</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">mean.frequency</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">condition</span><span class="p">),</span><span class="w">
           </span><span class="n">stat</span><span class="o">=</span><span class="s1">'identity'</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="n">position_dodge</span><span class="p">())</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"firebrick"</span><span class="p">,</span><span class="s2">"grey40"</span><span class="p">))</span><span class="o">+</span><span class="w"> </span><span class="c1"># pick colors manually</span><span class="w">
  </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"firebrick"</span><span class="p">,</span><span class="s2">"grey40"</span><span class="p">))</span><span class="o">+</span><span class="w"> </span><span class="c1"># pick colors manually</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">"Relative interaction\nfrequency"</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">"genomic coordinate"</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="c1"># rename axis labels</span><span class="w">
  </span><span class="n">theme_linedraw_noframe</span><span class="o">+</span><span class="w"> </span><span class="c1"># these are the theme settings defined above</span><span class="w">
  </span><span class="n">guides</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">F</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as
## of ggplot2 3.3.4.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
</code></pre></div></div>

<p><img src="/assets/img/2020-01-03-3C-arc-plot-w-barplot-1.png" alt=""></p>

  </article>

</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Lingbo  Shen. Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

      </div>
    </footer>
  </body>

  <!-- jQuery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  <!-- Mansory & imagesLoaded -->
  <script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
  <script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/mansory.js" type="text/javascript"></script>
  
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  
</html>

